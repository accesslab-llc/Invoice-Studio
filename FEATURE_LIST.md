# InvoiceStudio - 機能詳細リスト

**最終更新**: 2025年1月

## 概要

InvoiceStudioは、Monday.comのボードデータから請求書・見積書を簡単に作成・編集・ダウンロードできるMonday.comアプリケーションです。3ステップのシンプルなワークフローで、誰でもすぐにプロフェッショナルな請求書を作成できます。

---

## 1. 基本機能

### 1.1 ワークフロー
- **3ステップワークフロー**
  - ステップ1: アイテム選択（Monday.comボードからアイテムを選択）
  - ステップ2: 請求書編集（データの自動入力、カスタマイズ）
  - ステップ3: ダウンロード（PDF形式でダウンロード）
- **リアルタイムプレビュー**: 編集内容が即座にプレビューに反映
- **自動データ取得**: Monday.comボードから自動的にデータを取得

### 1.2 ドキュメントタイプ
- **請求書（Invoice）**: 標準的な請求書の作成
- **見積書（Estimate/Quote）**: 見積書の作成
  - 請求書とは異なる項目（有効期限、納期・提供時期、見積条件など）
  - 請求書と見積書で表示項目が自動的に切り替わる

---

## 2. Monday.com連携機能

### 2.1 データ取得
- **ボードデータの自動取得**: Monday.comのボードからアイテムを自動取得
- **サブアイテム対応**: サブアイテムを明細（line items）として自動変換
- **カラムタイプ対応**: 以下のカラムタイプからデータを取得可能
  - テキスト（text）
  - 数値（numeric）
  - 日付（date）
  - ステータス（status）
  - 人物（person）
  - メール（email）
  - 電話番号（phone）
  - リンク（link）
  - ファイル（file）
  - チェックボックス（checkbox）
  - レーティング（rating）
  - タイムライン（timeline）
  - 依存関係（dependency）
  - ロケーション（location）
  - タグ（tags）
  - 投票（vote）
  - 時間（hour）
  - 週（week）
  - アイテムID（item_id）
  - ボードリレーション（board_relation）
  - 自動番号（auto_number）
  - 作成ログ（creation_log）
  - 最終更新（last_updated）
  - ミラーカラム（mirror）
  - その他多数

### 2.2 フィールドマッピング機能
- **柔軟なマッピング設定**: Monday.comボードのカラムと請求書項目を自由にマッピング
- **マッピング可能なフィールド**:
  - **基本情報**: 請求書番号、請求日、支払期限（請求書）、有効期限（見積書）
  - **請求先情報**: 請求先名、部署、担当者、郵便番号、住所、電話番号、メールアドレス
  - **金額・明細**: 割引、税額、明細（サブアイテム）、価格カラム、数量カラム
- **マッピングオプション**:
  - **手動入力**: 手動で値を入力
  - **必要なし**: 項目を非表示（空欄の場合は自動的に非表示）
  - **ボードカラム**: Monday.comボードのカラムを選択
  - **カスタムカラムID**: カラムIDを直接入力（例: `text_mkwjtrys`）
  - **サブアイテム**: 明細としてサブアイテムを使用
- **マッピングの保存**: ローカルストレージに保存され、次回以降も使用可能
- **リアルタイム反映**: マッピング保存後、選択中のアイテムのデータが自動的に再読み込み

### 2.3 アイテム選択機能
- **アイテム一覧表示**: Monday.comボードのアイテムを一覧表示
- **検索機能**: アイテム名やグループ名で検索・絞り込み
- **グループフィルター**: 特定のグループのアイテムのみを表示
- **複数選択**: チェックボックスで複数のアイテムを選択可能（現在は1つのみ対応）
- **選択状態の保持**: 選択したアイテムの情報を保持

---

## 3. 多言語・多通貨対応

### 3.1 多言語対応
- **対応言語**: 日本語、英語、スペイン語
- **言語切り替え**: アプリ上部の言語選択から切り替え可能
- **翻訳範囲**:
  - UI要素（ボタン、ラベル、メッセージなど）
  - 請求書テンプレート内のテキスト
  - フィールドマッピング画面
  - ヘルプダイアログ
  - エラーメッセージ
- **日付フォーマット**: 言語に応じて自動的に変更
  - 日本語: YYYY年MM月DD日
  - 英語: MM/DD/YYYY
  - スペイン語: DD/MM/YYYY

### 3.2 多通貨対応
- **対応通貨**: JPY（日本円）、USD（米ドル）、EUR（ユーロ）、GBP（英ポンド）、CNY（中国元）
- **通貨記号の自動表示**: 選択した通貨に応じて通貨記号を自動表示
- **通貨切り替え**: 請求書編集画面で通貨を選択可能

---

## 4. テンプレート機能

### 4.1 レイアウトテンプレート
- **3つのテンプレート**:
  - **モダン（Modern）**: シンプルで洗練されたデザイン。色付きの背景を使用
  - **クラシック（Classic）**: 伝統的な請求書スタイル。白背景で左側にアクセントライン
  - **ミニマル（Minimal）**: シンプルで読みやすいデザイン。最小限の装飾
- **テンプレートカラーのカスタマイズ**: 各テンプレートのカラーを自由に変更可能
- **テンプレート切り替え**: 編集画面でテンプレートを選択可能

### 4.2 データテンプレート（保存機能）
- **テンプレート管理**: 発行元情報、マッピング設定、画像などをテンプレートとして保存
- **保存内容**:
  - 請求書の全項目（formData）
  - フィールドマッピング設定（fieldMappings）
  - 画像（会社ロゴ、署名、透かし）のBase64データ
  - 画像設定（サイズ、位置、透明度など）
  - テンプレートカラー設定
  - 通貨設定
  - その他すべての設定
- **テンプレート操作**:
  - **一覧表示**: 保存済みテンプレートを一覧表示
  - **選択**: テンプレートをクリックして選択
  - **適用**: 選択したテンプレートを請求書に適用（全項目とマッピングを復元）
  - **削除**: 不要なテンプレートを削除
  - **新規保存**: 現在の請求書の内容を新規テンプレートとして保存（テンプレート名を設定）
- **テンプレート管理UI**: 
  - テンプレート一覧を表示
  - 選択したテンプレートに対して適用・削除ボタンを同じ行に表示
  - 新規保存は選択に関係なく常に可能

---

## 5. 請求書編集機能

### 5.1 基本情報
- **請求書番号**: 手動入力またはマッピング
- **請求日**: 日付選択またはマッピング
- **支払期限（請求書のみ）**: 日付選択またはマッピング
- **有効期限（見積書のみ）**: 日付選択またはマッピング
- **支払条件**: 支払期限までの日数を設定（例: 30日）

### 5.2 発行元情報
- **会社名**: 必須
- **代表者**: 任意
- **郵便番号**: 任意
- **住所**: 任意
- **電話番号**: 任意
- **FAX**: 任意
- **メールアドレス**: 任意
- **登録番号**: 任意（法人番号など）
- **空欄項目の自動非表示**: 空欄の項目は自動的に非表示になり、詰めて表示

### 5.3 請求先情報
- **請求先名**: 必須
- **部署**: 任意
- **担当者**: 任意（「様」が自動的に付与）
- **郵便番号**: 任意
- **住所**: 任意
- **電話番号**: 任意
- **メールアドレス**: 任意
- **空欄項目の自動非表示**: 空欄の項目は自動的に非表示になり、詰めて表示

### 5.4 明細（Line Items）
- **サブアイテムからの自動取得**: Monday.comのサブアイテムを明細として自動変換
- **明細項目**:
  - **品名**: サブアイテム名
  - **数量**: サブアイテムの数量カラムまたは手動入力
  - **単価**: サブアイテムの価格カラム
  - **金額**: 数量 × 単価（自動計算）
- **価格カラム・数量カラムのマッピング**: 
  - アイテムのカラムとサブアイテムのカラムの両方を選択可能
  - 手動入力、必要なしのオプションも選択可能
- **合計計算**: 小計、割引、税額、合計を自動計算

### 5.5 金額計算
- **小計**: 明細の合計金額
- **割引**: 割引額（マッピングまたは手動入力）
- **税額**: 税率と税額（マッピングまたは手動入力）
- **税率**: デフォルト10%（変更可能）
- **合計**: 小計 - 割引 + 税額（自動計算）

### 5.6 振込先情報（請求書のみ）
- **銀行名**: 任意
- **口座種別**: 任意（普通、当座など）
- **口座番号**: 任意
- **口座名義**: 任意
- **空欄項目の自動非表示**: 空欄の項目は自動的に非表示

### 5.7 納期・提供時期（見積書のみ）
- **タイプ選択**: 「納期」または「作業期間」を選択
- **納期**: 例: 「ご発注後 2週間以内」
- **作業期間**: 例: 「2026年2月1日〜2月28日」

### 5.8 備考・見積条件
- **備考（請求書）**: 任意のテキストを入力
- **見積条件（見積書）**: 任意のテキストを入力
- **ラベル変更**: 見積書の場合、「備考」を「見積条件」などに変更可能
- **デフォルトテキスト**: 請求書の場合、「※振込手数料はお客様負担でお願い致します。」がデフォルト

---

## 6. 画像機能

### 6.1 画像アップロード
- **会社ロゴ**: 請求書のヘッダーに表示
- **署名/印鑑**: 請求書のフッターに表示
- **背景の透かし**: 請求書の背景に表示

### 6.2 画像設定
- **会社ロゴ設定**:
  - 幅・高さの調整
  - 位置調整（x, y座標）
  - 回転角度
  - 繰り返し表示（tiling）
- **署名/印鑑設定**:
  - サイズ調整（1ページに収める場合の自動調整）
- **背景透かし設定**:
  - **サイズ**: 小、中、大（3段階）
  - **位置**: 上、中央、下（3段階）
  - **透明度**: 0.1（デフォルト）
  - **プレビュー画面での調整**: プレビュー画面で直接サイズと位置を調整可能

### 6.3 画像形式
- **対応形式**: 画像ファイル（JPEG、PNGなど）
- **Base64エンコード**: 画像はBase64形式で保存・表示
- **テンプレート保存**: 画像もテンプレートに含めて保存

---

## 7. セクション表示制御

### 7.1 表示/非表示切り替え
- **発行元情報**: 表示/非表示を切り替え可能
- **請求先情報**: 表示/非表示を切り替え可能
- **振込先情報**: 表示/非表示を切り替え可能（請求書のみ）
- **備考**: 表示/非表示を切り替え可能
- **画像設定**: 表示/非表示を切り替え可能

### 7.2 空欄項目の自動非表示
- **自動非表示機能**: 空欄の項目は自動的に非表示
- **詰めて表示**: 空欄項目を削除して詰めて表示
- **適用範囲**:
  - 請求書番号・請求日が空欄の場合は項目ごと非表示
  - 請求先・発行元が空欄の場合は項目ごと非表示（「-」も表示しない）
  - 各項目内の空欄フィールドも自動的に非表示

---

## 8. PDF生成・ダウンロード機能

### 8.1 PDF生成
- **PDF形式でのダウンロード**: HTMLからPDFを生成
- **ライブラリ**: html2canvas + jsPDFを使用
- **生成時間**: 数秒かかる場合がある（処理中メッセージを表示）

### 8.2 ページ設定
- **用紙サイズ**: A4、Letter、Legal、Tabloid、Executive、A3、A5、B4、B5
- **1ページに収める**: オプションで1ページに収める設定
  - アイテム数に応じてフォントサイズとパディングを自動調整
  - 12個以上: 5mm、8-12個: 6mm、5-8個: 7mm、5個以下: 8mm
- **向き**: 縦向き（Portrait）

### 8.3 プレビュー機能
- **リアルタイムプレビュー**: 編集内容が即座にプレビューに反映
- **プレビュー画面での調整**:
  - 背景透かしのサイズ調整（小、中、大）
  - 背景透かしの位置調整（上、中央、下）
- **プレビューとPDFの一致**: プレビューとPDFの表示が一致

### 8.4 ファイル名
- **自動命名**: `invoice-{請求書番号}.pdf` または `estimate-{見積書番号}.pdf`
- **日本語対応**: ファイル名に日本語が含まれる場合も正しく処理

---

## 9. UI/UX機能

### 9.1 レスポンシブデザイン
- **モバイル対応**: レスポンシブデザインでモバイルでも使用可能
- **画面サイズに応じたレイアウト**: 画面サイズに応じてレイアウトが自動調整

### 9.2 ローディング表示
- **スケルトン表示**: データ読み込み中にスケルトン表示
- **処理中メッセージ**: PDF生成中などに処理中メッセージを表示

### 9.3 エラーハンドリング
- **認証エラー**: Monday.comの認証エラーを表示
- **データ取得エラー**: データ取得失敗時のエラーメッセージ
- **バリデーション**: 入力値のバリデーション

### 9.4 ヘルプ機能
- **ヘルプダイアログ**: アプリの使い方を説明
- **多言語対応**: ヘルプも多言語対応

---

## 10. データ管理機能

### 10.1 ローカルストレージ
- **フィールドマッピングの保存**: ローカルストレージに保存
- **テンプレートの保存**: ローカルストレージに保存
- **データの永続化**: ブラウザを閉じてもデータが保持

### 10.2 データの自動読み込み
- **起動時の自動読み込み**: アプリ起動時にMonday.comボードから自動的にデータを取得
- **マッピング保存後の再読み込み**: マッピング保存後、選択中のアイテムのデータを自動的に再読み込み

---

## 11. セキュリティ・プライバシー

### 11.1 データ処理
- **クライアントサイド処理**: すべてのデータ処理はブラウザ内で実行
- **サーバーへの送信なし**: データはサーバーに送信されない
- **Monday.com認証**: Monday.comの認証を使用した安全なデータ取得

### 11.2 データ保存
- **ローカルストレージのみ**: データはローカルストレージにのみ保存
- **外部送信なし**: データは外部に送信されない

---

## 12. 技術仕様

### 12.1 使用技術
- **フレームワーク**: React
- **UIライブラリ**: Chakra UI
- **PDF生成**: html2canvas + jsPDF
- **Monday.com SDK**: monday-sdk-js
- **GraphQL**: Monday.com GraphQL API

### 12.2 対応環境
- **ブラウザ**: モダンブラウザ（Chrome、Firefox、Safari、Edge）
- **Monday.com**: Monday.comアプリとして動作（iframe形式）

### 12.3 必要な権限
- **boards:read**: ボードデータの読み取り
- **items:read**: アイテムデータの読み取り
- **subitems:read**: サブアイテムデータの読み取り

---

## 13. 制限事項・注意点

### 13.1 Monday.com APIの制限
- **数式カラム**: 数式カラムからはデータを取得できない（数式の元となるカラムをマッピングする必要がある）
- **数式カラムを参照するミラーカラム**: 数式カラムを参照するミラーカラムからもデータを取得できない
- **接続カラム（ボード接続）**: 接続カラムからは接続されたアイテムの名前を取得できない（手動入力が必要）

### 13.2 その他の制限
- **複数アイテムの同時処理**: 現在は1つのアイテムのみ対応（複数選択は可能だが、1つずつ処理）
- **PDF生成時間**: 大量の明細がある場合、PDF生成に時間がかかる場合がある

---

## 14. 今後の拡張可能性

### 14.1 機能拡張の余地
- **複数アイテムの一括処理**: 複数のアイテムから一度に請求書を作成
- **請求書の送信機能**: メール送信機能の追加
- **請求書の履歴管理**: 作成した請求書の履歴を保存・管理
- **承認ワークフロー**: 請求書の承認プロセス
- **レポート機能**: 請求書の統計・レポート機能

---

## まとめ

InvoiceStudioは、Monday.comのボードデータを活用して、プロフェッショナルな請求書・見積書を簡単に作成できるアプリケーションです。3ステップのシンプルなワークフロー、多言語・多通貨対応、柔軟なフィールドマッピング、豊富なカスタマイズ機能により、様々なビジネスシーンで活用できます。

**主な強み**:
- Monday.comとの深い統合
- 直感的なUI/UX
- 多言語・多通貨対応
- 柔軟なカスタマイズ機能
- クライアントサイド処理によるセキュリティ
- リアルタイムプレビュー

**ターゲットユーザー**:
- フリーランス・個人事業主
- 中小企業の経理担当者
- プロジェクトマネージャー
- サービス提供事業者

